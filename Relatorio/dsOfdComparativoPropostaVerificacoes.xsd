<?xml version="1.0" encoding="utf-8"?>
<xs:schema id="dsOfdComparativoPropostaVerificacoes" targetNamespace="http://tempuri.org/dsOfdComparativoPropostaVerificacoes.xsd" xmlns:mstns="http://tempuri.org/dsOfdComparativoPropostaVerificacoes.xsd" xmlns="http://tempuri.org/dsOfdComparativoPropostaVerificacoes.xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" xmlns:msprop="urn:schemas-microsoft-com:xml-msprop" attributeFormDefault="qualified" elementFormDefault="qualified">
  <xs:annotation>
    <xs:appinfo source="urn:schemas-microsoft-com:xml-msdatasource">
      <DataSource DefaultConnectionIndex="0" FunctionsComponentName="QueriesTableAdapter" Modifier="AutoLayout, AnsiClass, Class, Public" SchemaSerializationMode="IncludeSchema" xmlns="urn:schemas-microsoft-com:xml-msdatasource">
        <Connections>
          <Connection AppSettingsObjectName="Settings" AppSettingsPropertyName="cwkcwkGestaoConnectionString" ConnectionStringObject="" IsAppSettingsProperty="true" Modifier="Assembly" Name="cwkcwkGestaoConnectionString (Settings)" ParameterPrefix="@" PropertyReference="ApplicationSettings.Relatorio.Properties.Settings.GlobalReference.Default.cwkcwkGestaoConnectionString" Provider="System.Data.SqlClient" />
        </Connections>
        <Tables>
          <TableAdapter BaseClass="System.ComponentModel.Component" DataAccessorModifier="AutoLayout, AnsiClass, Class, Public" DataAccessorName="dsOfdComparativoPropostaVerificacoesTableAdapter" GeneratorDataComponentClassName="dsOfdComparativoPropostaVerificacoesTableAdapter" Name="dsOfdComparativoPropostaVerificacoes" UserDataComponentName="dsOfdComparativoPropostaVerificacoesTableAdapter">
            <MainSource>
              <DbSource ConnectionRef="cwkcwkGestaoConnectionString (Settings)" DbObjectType="Unknown" FillMethodModifier="Public" FillMethodName="Fill" GenerateMethods="Both" GenerateShortCommands="false" GeneratorGetMethodName="GetData" GeneratorSourceName="Fill" GetMethodModifier="Public" GetMethodName="GetData" QueryType="Rowset" ScalarCallRetval="System.Object, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" UseOptimisticConcurrency="false" UserGetMethodName="GetData" UserSourceName="Fill">
                <SelectCommand>
                  <DbCommand CommandType="Text" ModifiedByUser="true">
                    <CommandText>select	M.id, m.Sequencia, M.Relatorio, Convert(date,M.DataRelatorio) as 'DataRelatorio', Convert(date,M.DataVerificacao) as 'DataVerificacao', isnull(m.Estaca,p.Estaca) Estaca, dbo.f_OfdTipoDiametro(m.Diametro) Diametro, dbo.f_OfdTipoDiametro(p.Diametro) DiametroProposta,
		m.Quantidade, p.Quantidade QuantidadeProposta, m.Profundidade, p.Profundidade ProfundidadeProposta, m.Total, p.Total TotalProposta,
		f.Nome as 'EmpNome',
		f.CNPJ as 'EmpCNPJ',
		f.Telefone as 'EmpTelefone',
		f.endereco + ', ' + f.Numero + ', '  + f.Bairro +  ' - ' + c.Nome + ' - ' + uf.Sigla + ' - CEP: ' + f.CEP   AS 'EmpEnd',
		'Proposta: '+NumeroProposta + ' - Obra: '+ NomeObra Parametro,
		[dbo].F_DataHoraExtenso(GETDATE()) DataHoraImpressao
    from 
    (Select Estaca, Diametro, Quantidade, Profundidade, Total, NumeroProposta, NomeObra
        from (
	    SELECT prp.Revisao, Estaca, Diametro, Quantidade, Profundidade, Quantidade * Profundidade Total, p.NumeroProposta, p.NomeObra
	        from Ofd_Proposta as p
	        left join Ofd_PropostaRevisaoPerfuracoes as prp on prp.ID = (select max(id) from Ofd_PropostaRevisaoPerfuracoes UltimaRevisao where UltimaRevisao.IDOfd_Proposta = p.id)
	        left join Ofd_PropostaPerfuracoes as pp on pp.IDOfd_PropostaRevisaoPerfuracoes = prp.ID
	        where p.id = @idProposta
		    )Proposta
    ) P
    full join

    (Select id, Sequencia, Relatorio, DataRelatorio, DataVerificacao, Estaca, Diametro, Quantidade, Profundidade, Total
        from (
        SELECT pm.id, pm.Sequencia, pm.Relatorio, pm.DataRelatorio, pm.DataVerificacao, Estaca, Diametro, Quantidade, Profundidade, Quantidade * Profundidade Total 
        from Ofd_Proposta as p
        left join Ofd_PropostaMedicao as pm on pm.IDProposta = p.ID
        left join Ofd_PropostaMedicaoPerfuracao as pmp on pmp.IDPropostaMedicao = pm.id
        where p.id = @idProposta
	        ) Medicao
    ) M on UPPER(m.Estaca) = UPPER(P.Estaca),
	(select top(1)* from Filial order by id) f
	join Cidade c on c.ID = f.IDCidade
	join UF uf on uf.ID = c.IDUF
	order by DataRelatorio, id, Sequencia</CommandText>
                    <Parameters>
                      <Parameter AllowDbNull="false" AutogeneratedName="idProposta" ColumnName="" DataSourceName="" DataTypeServer="int" DbType="Int32" Direction="Input" ParameterName="@idProposta" Precision="0" Scale="0" Size="4" SourceColumn="" SourceColumnNullMapping="false" SourceVersion="Current" />
                    </Parameters>
                  </DbCommand>
                </SelectCommand>
              </DbSource>
            </MainSource>
            <Mappings>
              <Mapping SourceColumn="id" DataSetColumn="id" />
              <Mapping SourceColumn="Sequencia" DataSetColumn="Sequencia" />
              <Mapping SourceColumn="Relatorio" DataSetColumn="Relatorio" />
              <Mapping SourceColumn="Estaca" DataSetColumn="Estaca" />
              <Mapping SourceColumn="Diametro" DataSetColumn="Diametro" />
              <Mapping SourceColumn="DiametroProposta" DataSetColumn="DiametroProposta" />
              <Mapping SourceColumn="Profundidade" DataSetColumn="Profundidade" />
              <Mapping SourceColumn="ProfundidadeProposta" DataSetColumn="ProfundidadeProposta" />
              <Mapping SourceColumn="Total" DataSetColumn="Total" />
              <Mapping SourceColumn="TotalProposta" DataSetColumn="TotalProposta" />
              <Mapping SourceColumn="DataRelatorio" DataSetColumn="DataRelatorio" />
              <Mapping SourceColumn="DataVerificacao" DataSetColumn="DataVerificacao" />
              <Mapping SourceColumn="Quantidade" DataSetColumn="Quantidade" />
              <Mapping SourceColumn="QuantidadeProposta" DataSetColumn="QuantidadeProposta" />
              <Mapping SourceColumn="EmpNome" DataSetColumn="EmpNome" />
              <Mapping SourceColumn="EmpCNPJ" DataSetColumn="EmpCNPJ" />
              <Mapping SourceColumn="EmpTelefone" DataSetColumn="EmpTelefone" />
              <Mapping SourceColumn="EmpEnd" DataSetColumn="EmpEnd" />
              <Mapping SourceColumn="Parametro" DataSetColumn="Parametro" />
              <Mapping SourceColumn="DataHoraImpressao" DataSetColumn="DataHoraImpressao" />
            </Mappings>
            <Sources />
          </TableAdapter>
        </Tables>
        <Sources />
      </DataSource>
    </xs:appinfo>
  </xs:annotation>
  <xs:element name="dsOfdComparativoPropostaVerificacoes" msdata:IsDataSet="true" msdata:UseCurrentLocale="true" msprop:Generator_UserDSName="dsOfdComparativoPropostaVerificacoes" msprop:Generator_DataSetName="dsOfdComparativoPropostaVerificacoes" msprop:EnableTableAdapterManager="true">
    <xs:complexType>
      <xs:choice minOccurs="0" maxOccurs="unbounded">
        <xs:element name="dsOfdComparativoPropostaVerificacoes" msprop:Generator_UserTableName="dsOfdComparativoPropostaVerificacoes" msprop:Generator_RowDeletedName="dsOfdComparativoPropostaVerificacoesRowDeleted" msprop:Generator_RowChangedName="dsOfdComparativoPropostaVerificacoesRowChanged" msprop:Generator_RowClassName="dsOfdComparativoPropostaVerificacoesRow" msprop:Generator_RowChangingName="dsOfdComparativoPropostaVerificacoesRowChanging" msprop:Generator_RowEvArgName="dsOfdComparativoPropostaVerificacoesRowChangeEvent" msprop:Generator_RowEvHandlerName="dsOfdComparativoPropostaVerificacoesRowChangeEventHandler" msprop:Generator_TableClassName="dsOfdComparativoPropostaVerificacoesDataTable" msprop:Generator_TableVarName="tabledsOfdComparativoPropostaVerificacoes" msprop:Generator_RowDeletingName="dsOfdComparativoPropostaVerificacoesRowDeleting" msprop:Generator_TablePropName="_dsOfdComparativoPropostaVerificacoes">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="id" msdata:ReadOnly="true" msdata:AutoIncrement="true" msdata:AutoIncrementSeed="-1" msdata:AutoIncrementStep="-1" msprop:Generator_UserColumnName="id" msprop:Generator_ColumnVarNameInTable="columnid" msprop:Generator_ColumnPropNameInRow="id" msprop:Generator_ColumnPropNameInTable="idColumn" type="xs:int" minOccurs="0" />
              <xs:element name="Sequencia" msprop:Generator_UserColumnName="Sequencia" msprop:Generator_ColumnVarNameInTable="columnSequencia" msprop:Generator_ColumnPropNameInRow="Sequencia" msprop:Generator_ColumnPropNameInTable="SequenciaColumn" type="xs:int" minOccurs="0" />
              <xs:element name="Relatorio" msprop:Generator_UserColumnName="Relatorio" msprop:Generator_ColumnVarNameInTable="columnRelatorio" msprop:Generator_ColumnPropNameInRow="Relatorio" msprop:Generator_ColumnPropNameInTable="RelatorioColumn" type="xs:int" minOccurs="0" />
              <xs:element name="Estaca" msdata:ReadOnly="true" msprop:Generator_UserColumnName="Estaca" msprop:Generator_ColumnVarNameInTable="columnEstaca" msprop:Generator_ColumnPropNameInRow="Estaca" msprop:Generator_ColumnPropNameInTable="EstacaColumn" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="200" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="Diametro" msdata:ReadOnly="true" msprop:Generator_UserColumnName="Diametro" msprop:Generator_ColumnVarNameInTable="columnDiametro" msprop:Generator_ColumnPropNameInRow="Diametro" msprop:Generator_ColumnPropNameInTable="DiametroColumn" type="xs:decimal" minOccurs="0" />
              <xs:element name="DiametroProposta" msdata:ReadOnly="true" msprop:Generator_UserColumnName="DiametroProposta" msprop:Generator_ColumnVarNameInTable="columnDiametroProposta" msprop:Generator_ColumnPropNameInRow="DiametroProposta" msprop:Generator_ColumnPropNameInTable="DiametroPropostaColumn" type="xs:decimal" minOccurs="0" />
              <xs:element name="Profundidade" msprop:Generator_UserColumnName="Profundidade" msprop:Generator_ColumnVarNameInTable="columnProfundidade" msprop:Generator_ColumnPropNameInRow="Profundidade" msprop:Generator_ColumnPropNameInTable="ProfundidadeColumn" type="xs:decimal" minOccurs="0" />
              <xs:element name="ProfundidadeProposta" msprop:Generator_UserColumnName="ProfundidadeProposta" msprop:Generator_ColumnVarNameInTable="columnProfundidadeProposta" msprop:Generator_ColumnPropNameInRow="ProfundidadeProposta" msprop:Generator_ColumnPropNameInTable="ProfundidadePropostaColumn" type="xs:decimal" minOccurs="0" />
              <xs:element name="Total" msdata:ReadOnly="true" msprop:Generator_UserColumnName="Total" msprop:Generator_ColumnVarNameInTable="columnTotal" msprop:Generator_ColumnPropNameInRow="Total" msprop:Generator_ColumnPropNameInTable="TotalColumn" type="xs:decimal" minOccurs="0" />
              <xs:element name="TotalProposta" msdata:ReadOnly="true" msprop:Generator_UserColumnName="TotalProposta" msprop:Generator_ColumnVarNameInTable="columnTotalProposta" msprop:Generator_ColumnPropNameInRow="TotalProposta" msprop:Generator_ColumnPropNameInTable="TotalPropostaColumn" type="xs:decimal" minOccurs="0" />
              <xs:element name="DataRelatorio" msdata:ReadOnly="true" msprop:Generator_UserColumnName="DataRelatorio" msprop:Generator_ColumnVarNameInTable="columnDataRelatorio" msprop:Generator_ColumnPropNameInRow="DataRelatorio" msprop:Generator_ColumnPropNameInTable="DataRelatorioColumn" type="xs:dateTime" minOccurs="0" />
              <xs:element name="DataVerificacao" msdata:ReadOnly="true" msprop:Generator_UserColumnName="DataVerificacao" msprop:Generator_ColumnVarNameInTable="columnDataVerificacao" msprop:Generator_ColumnPropNameInRow="DataVerificacao" msprop:Generator_ColumnPropNameInTable="DataVerificacaoColumn" type="xs:dateTime" minOccurs="0" />
              <xs:element name="Quantidade" msprop:Generator_UserColumnName="Quantidade" msprop:Generator_ColumnPropNameInRow="Quantidade" msprop:Generator_ColumnVarNameInTable="columnQuantidade" msprop:Generator_ColumnPropNameInTable="QuantidadeColumn" type="xs:decimal" minOccurs="0" />
              <xs:element name="QuantidadeProposta" msprop:Generator_UserColumnName="QuantidadeProposta" msprop:Generator_ColumnPropNameInRow="QuantidadeProposta" msprop:Generator_ColumnVarNameInTable="columnQuantidadeProposta" msprop:Generator_ColumnPropNameInTable="QuantidadePropostaColumn" type="xs:decimal" minOccurs="0" />
              <xs:element name="EmpNome" msprop:Generator_UserColumnName="EmpNome" msprop:Generator_ColumnPropNameInRow="EmpNome" msprop:Generator_ColumnVarNameInTable="columnEmpNome" msprop:Generator_ColumnPropNameInTable="EmpNomeColumn">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="60" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="EmpCNPJ" msprop:Generator_UserColumnName="EmpCNPJ" msprop:Generator_ColumnPropNameInRow="EmpCNPJ" msprop:Generator_ColumnVarNameInTable="columnEmpCNPJ" msprop:Generator_ColumnPropNameInTable="EmpCNPJColumn" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="20" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="EmpTelefone" msprop:Generator_UserColumnName="EmpTelefone" msprop:Generator_ColumnPropNameInRow="EmpTelefone" msprop:Generator_ColumnVarNameInTable="columnEmpTelefone" msprop:Generator_ColumnPropNameInTable="EmpTelefoneColumn" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="20" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="EmpEnd" msdata:ReadOnly="true" msprop:Generator_UserColumnName="EmpEnd" msprop:Generator_ColumnPropNameInRow="EmpEnd" msprop:Generator_ColumnVarNameInTable="columnEmpEnd" msprop:Generator_ColumnPropNameInTable="EmpEndColumn" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="256" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="Parametro" msdata:ReadOnly="true" msprop:Generator_UserColumnName="Parametro" msprop:Generator_ColumnVarNameInTable="columnParametro" msprop:Generator_ColumnPropNameInRow="Parametro" msprop:Generator_ColumnPropNameInTable="ParametroColumn" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="319" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
              <xs:element name="DataHoraImpressao" msdata:ReadOnly="true" msprop:Generator_UserColumnName="DataHoraImpressao" msprop:Generator_ColumnVarNameInTable="columnDataHoraImpressao" msprop:Generator_ColumnPropNameInRow="DataHoraImpressao" msprop:Generator_ColumnPropNameInTable="DataHoraImpressaoColumn" minOccurs="0">
                <xs:simpleType>
                  <xs:restriction base="xs:string">
                    <xs:maxLength value="30" />
                  </xs:restriction>
                </xs:simpleType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:choice>
    </xs:complexType>
  </xs:element>
</xs:schema>